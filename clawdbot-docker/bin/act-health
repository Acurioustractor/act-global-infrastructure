#!/usr/bin/env node

/**
 * act-health - Check ACT ecosystem service health
 *
 * Usage:
 *   act-health
 */

import intelligence from '../scripts/intelligence-api.mjs';

console.log('üîç Checking ACT ecosystem services...\n');

try {
  const health = await intelligence.healthCheck();

  if (health.status === 'connected') {
    console.log('‚úÖ Intelligence Platform: Connected');
    console.log(`   URL: ${health.url}\n`);

    if (health.services.search) {
      const search = health.services.search;
      console.log(`   Search Service: ${search.status === 'healthy' ? '‚úÖ' : '‚ö†Ô∏è'} ${search.status}`);
      if (search.embeddingService) {
        console.log(`   Embeddings: ${search.embeddingService.status}`);
      }
    }

    if (health.services.agents) {
      const agents = health.services.agents;
      console.log(`   Farmhand Agents: ${agents.farmhand === 'connected' ? '‚úÖ' : '‚ö†Ô∏è'} ${agents.farmhand}`);
    }
  } else {
    console.log('‚ùå Intelligence Platform: Disconnected');
    console.log(`   URL: ${health.url}`);
    console.log(`   Error: ${health.error}`);
    console.log('\nüí° Make sure the Intelligence Platform is running.');
    process.exit(1);
  }

  console.log('\n‚ú® All systems operational!');
} catch (error) {
  console.error('‚ùå Health check failed:', error.message);
  process.exit(1);
}
